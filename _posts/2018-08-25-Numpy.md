---
layout: mypost
title: Introduction to Numpy
categories: [Numpy]
---


```python
import numpy as np
```

### Numpy Array

#### One-dimensional


```python
lst1 = [1, 2, 3, 4, 5]
arr1 = np.array(lst1)
arr1
```




    array([1, 2, 3, 4, 5])




```python
type(arr1)
```




    numpy.ndarray




```python
arr1 + 2
```




    array([3, 4, 5, 6, 7])



#### Two-dimensional


```python
lst2 = [[0, 1, 2], [3, 4, 5]]
arr2 = np.array(lst2)
```


```python
arr2
```




    array([[0, 1, 2],
           [3, 4, 5]])



### Type Conversion


```python
arr3 = np.array(lst2, dtype='float')
arr3
```




    array([[0., 1., 2.],
           [3., 4., 5.]])




```python
arr4 = arr3.astype('int')
arr4
```




    array([[0, 1, 2],
           [3, 4, 5]])



### Properties
* shape
* size
* dtype
* dimension


```python
arr4.shape
```




    (2, 3)




```python
arr4.size
```




    6




```python
arr4.dtype
```




    dtype('int64')




```python
arr4.ndim
```




    2



### Index


```python
arr4
```




    array([[0, 1, 2],
           [3, 4, 5]])




```python
arr4[:2, :2]
```




    array([[0, 1],
           [3, 4]])




```python
idx4 = (arr4 % 2 == 0)
```


```python
arr4[idx4]
```




    array([0, 2, 4])



### Infinity and None


```python
np.inf
```




    inf




```python
np.nan
```




    nan




```python
arr4
```




    array([[0, 1, 2],
           [3, 4, 5]])




```python
arr4 = arr4.astype('float')
arr4[0][0] = np.nan
arr4[1][1] = np.inf
arr4
```




    array([[nan,  1.,  2.],
           [ 3., inf,  5.]])




```python
replace_idx = np.isnan(arr4) | np.isinf(arr4)
arr4[replace_idx] = 1
arr4
```




    array([[1., 1., 2.],
           [3., 1., 5.]])



### Statistics
* mean
* max
* min
* axis


```python
arr4.mean()
```




    2.1666666666666665




```python
arr4.max()
```




    5.0




```python
arr4.min()
```




    1.0



#### Max value of each column


```python
arr4.max(axis=0)
```




    array([3., 1., 5.])



#### Max value of each row


```python
arr4.max(axis=1)
```




    array([2., 5.])



### Copy an Array

#### Reference using '='


```python
arr3
```




    array([[0., 1., 2.],
           [3., 4., 5.]])




```python
arr3_cpy = arr3[:, 1:]
arr3_cpy
```




    array([[1., 2.],
           [4., 5.]])




```python
arr3_cpy[0][0] = 10
arr3_cpy
```




    array([[10.,  2.],
           [ 4.,  5.]])




```python
arr3
```




    array([[ 0., 10.,  2.],
           [ 3.,  4.,  5.]])



#### Copy


```python
arr4
```




    array([[1., 1., 2.],
           [3., 1., 5.]])




```python
arr4_cpy = arr4.copy()
arr4_cpy
```




    array([[1., 1., 2.],
           [3., 1., 5.]])




```python
arr4_cpy[0][0] = 10
arr4_cpy
```




    array([[10.,  1.,  2.],
           [ 3.,  1.,  5.]])




```python
arr4
```




    array([[1., 1., 2.],
           [3., 1., 5.]])



### Reshape and Flatten


```python
arr4
```




    array([[1., 1., 2.],
           [3., 1., 5.]])




```python
arr4.reshape(3, 2)
```




    array([[1., 1.],
           [2., 3.],
           [1., 5.]])




```python
arr4
```




    array([[1., 1., 2.],
           [3., 1., 5.]])




```python
arr4_ravel = arr4.ravel()
arr4_flatten = arr4.flatten()
```


```python
arr4_ravel
```




    array([1., 1., 2., 3., 1., 5.])




```python
arr4_flatten
```




    array([1., 1., 2., 3., 1., 5.])




```python
arr4_ravel[0] = np.inf
arr4
```




    array([[inf,  1.,  2.],
           [ 3.,  1.,  5.]])




```python
arr4_flatten[0] = np.nan
arr4
```




    array([[inf,  1.,  2.],
           [ 3.,  1.,  5.]])



**Conclusion**: ravel makes an reference and flatten creates a new array

### Faster Array Creation
* arange
* linspace
* logspace 
* tile
* repeat


```python
a = np.arange(9)
a = a.reshape(3, 3)
a
```




    array([[0, 1, 2],
           [3, 4, 5],
           [6, 7, 8]])




```python
b = np.arange(8, -1, -1)
b = b.reshape(3, 3)
b
```




    array([[8, 7, 6],
           [5, 4, 3],
           [2, 1, 0]])




```python
c = np.linspace(0, 5, 11)
c
```




    array([0. , 0.5, 1. , 1.5, 2. , 2.5, 3. , 3.5, 4. , 4.5, 5. ])




```python
np.set_printoptions(precision=4)
d = np.logspace(1,10, num=10, base=10)
d
```




    array([1.e+01, 1.e+02, 1.e+03, 1.e+04, 1.e+05, 1.e+06, 1.e+07, 1.e+08,
           1.e+09, 1.e+10])




```python
np.log10(d)
```




    array([ 1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10.])




```python
e = np.array([1, 2, 3])
tile_e = np.tile(e, 2)
repeat_e = np.repeat(e, 2)
```


```python
tile_e
```




    array([1, 2, 3, 1, 2, 3])




```python
repeat_e
```




    array([1, 1, 2, 2, 3, 3])



### Unique and Counts


```python
f = np.array(['blue', 'blue', 'red', 'green', 'yellow'])
```


```python
np.unique(f)
```




    array(['blue', 'green', 'red', 'yellow'], dtype='<U6')




```python
np.unique(f, return_counts=True, return_index=True)
```




    (array(['blue', 'green', 'red', 'yellow'], dtype='<U6'),
     array([0, 3, 2, 4]),
     array([2, 1, 1, 1]))



### Random


```python
np.random.seed(0)
```


```python
np.random.rand(3, 3)
```




    array([[0.5488, 0.7152, 0.6028],
           [0.5449, 0.4237, 0.6459],
           [0.4376, 0.8918, 0.9637]])




```python
np.random.randn(3, 3)
```




    array([[ 1.2661, -0.5059,  2.5452],
           [ 1.0808,  0.4843,  0.5791],
           [-0.1816,  1.4102, -0.3745]])




```python
np.random.randint(1, 10, size=(3, 3))
```




    array([[1, 2, 1],
           [5, 8, 4],
           [3, 8, 3]])




```python
np.random.choice(['red', 'blue', 'green'], size=10)
```




    array(['red', 'red', 'red', 'blue', 'blue', 'green', 'red', 'red', 'blue',
           'red'], dtype='<U5')




```python
np.random.choice(['red', 'blue', 'green'], size=10, p=[0.1, 0.1, 0.8])
```




    array(['green', 'green', 'green', 'green', 'red', 'green', 'green',
           'green', 'blue', 'green'], dtype='<U5')



### Conditional Index
* np.where()


```python
g = np.arange(9)
g
```




    array([0, 1, 2, 3, 4, 5, 6, 7, 8])




```python
idxg = np.where(g%2==0)
```


```python
g[idxg]
```




    array([0, 2, 4, 6, 8])




```python
np.where(g%2==0, -1, g)
```




    array([-1,  1, -1,  3, -1,  5, -1,  7, -1])



### Matrix Concatenation


```python
mtxa = np.arange(4).reshape(2,2)
mtxb = np.arange(6, 10).reshape(2,2)
```


```python
mtxa
```




    array([[0, 1],
           [2, 3]])




```python
mtxb
```




    array([[6, 7],
           [8, 9]])




```python
mtxc = np.concatenate([mtxa, mtxb], axis=0)
mtxc
```




    array([[0, 1],
           [2, 3],
           [6, 7],
           [8, 9]])



### I/O


```python
np.save('temp_mtxc', mtxc)
```


```python
load_mtxc = np.load('temp_mtxc.npy')
```


```python
load_mtxc
```




    array([[0, 1],
           [2, 3],
           [6, 7],
           [8, 9]])



**Read from CSV**: np.genfromtxt('your_path_to_data',delimiter=',', skip_header=1, filling_values=666.666, dtype='float')

**Save CSV**: np.savetxt('your_path_to_file', X, delimiter=',', header='')

### Vectorize Functions


```python
def foo(x):
    if x == 0:
        return 1
    else:
        return x
```


```python
foo(0), foo(1)
```




    (1, 1)




```python
h = np.array([0, 1, 2, 3])
```


```python
foo_v = np.vectorize(foo)
foo_v(h)
```




    array([1, 1, 2, 3])




```python
i = np.arange(6).reshape(2,3)
i
```




    array([[0, 1, 2],
           [3, 4, 5]])




```python
def foo2(x):
    return (max(x) - min(x)) / 2
```


```python
np.apply_along_axis(foo2, 0, i)
```




    array([1.5, 1.5, 1.5])




```python
np.apply_along_axis(foo2, 1, i)
```




    array([1., 1.])


