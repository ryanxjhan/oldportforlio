---
layout: mypost
title: Introduction to Pandas
categories: [Pandas]
---

### Import


{% highlight python linenos %}
import pandas as pd
import warnings
warnings.filterwarnings('ignore')
{% endhighlight %}

## I/O


```python
data = pd.read_csv('ad_feature.csv', header=0, sep=',')
data[:5].to_html('adhtml.csv', header=True)
data[:5].to_csv('adcsv.csv', header=True)
```

### Head and Tail


```python
data.head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>adgroup_id</th>
      <th>cate_id</th>
      <th>campaign_id</th>
      <th>customer</th>
      <th>brand</th>
      <th>price</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>63133</td>
      <td>6406</td>
      <td>83237</td>
      <td>1</td>
      <td>95471.0</td>
      <td>170.00</td>
    </tr>
    <tr>
      <th>1</th>
      <td>313401</td>
      <td>6406</td>
      <td>83237</td>
      <td>1</td>
      <td>87331.0</td>
      <td>199.00</td>
    </tr>
    <tr>
      <th>2</th>
      <td>248909</td>
      <td>392</td>
      <td>83237</td>
      <td>1</td>
      <td>32233.0</td>
      <td>38.00</td>
    </tr>
    <tr>
      <th>3</th>
      <td>208458</td>
      <td>392</td>
      <td>83237</td>
      <td>1</td>
      <td>174374.0</td>
      <td>139.00</td>
    </tr>
    <tr>
      <th>4</th>
      <td>110847</td>
      <td>7211</td>
      <td>135256</td>
      <td>2</td>
      <td>145952.0</td>
      <td>32.99</td>
    </tr>
  </tbody>
</table>
</div>




```python
data.tail()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>adgroup_id</th>
      <th>cate_id</th>
      <th>campaign_id</th>
      <th>customer</th>
      <th>brand</th>
      <th>price</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>846806</th>
      <td>824255</td>
      <td>4526</td>
      <td>380022</td>
      <td>255868</td>
      <td>389713.0</td>
      <td>268.0</td>
    </tr>
    <tr>
      <th>846807</th>
      <td>790170</td>
      <td>4280</td>
      <td>379736</td>
      <td>255872</td>
      <td>322171.0</td>
      <td>68.0</td>
    </tr>
    <tr>
      <th>846808</th>
      <td>845286</td>
      <td>6261</td>
      <td>379736</td>
      <td>255872</td>
      <td>322171.0</td>
      <td>88.0</td>
    </tr>
    <tr>
      <th>846809</th>
      <td>824732</td>
      <td>4520</td>
      <td>379736</td>
      <td>255872</td>
      <td>322171.0</td>
      <td>68.0</td>
    </tr>
    <tr>
      <th>846810</th>
      <td>845337</td>
      <td>11156</td>
      <td>379603</td>
      <td>255874</td>
      <td>74120.0</td>
      <td>279.0</td>
    </tr>
  </tbody>
</table>
</div>



### Series


```python
lst = [1, 2, 3, 4, 5]
srs = pd.Series(lst, index=['a', 'b', 'c', 'd', 'e'])
srs
```




    a    1
    b    2
    c    3
    d    4
    e    5
    dtype: int64



### Data Frame


```python
dic = {'A': [1, 2, 3, 4, 5], 'B': [10, 20, 30, 40, 50]}
df = pd.DataFrame(dic, index=['red', 'blue', 'green', 'yellow', 'white'])
df
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>red</th>
      <td>1</td>
      <td>10</td>
    </tr>
    <tr>
      <th>blue</th>
      <td>2</td>
      <td>20</td>
    </tr>
    <tr>
      <th>green</th>
      <td>3</td>
      <td>30</td>
    </tr>
    <tr>
      <th>yellow</th>
      <td>4</td>
      <td>40</td>
    </tr>
    <tr>
      <th>white</th>
      <td>5</td>
      <td>50</td>
    </tr>
  </tbody>
</table>
</div>



### Describe


```python
data['price'].describe()
```




    count    8.468110e+05
    mean     1.838867e+03
    std      3.108877e+05
    min      1.000000e-02
    25%      4.900000e+01
    50%      1.390000e+02
    75%      3.520000e+02
    max      1.000000e+08
    Name: price, dtype: float64



### Iterate


```python
for row in data[:5].itertuples():
    print(row.adgroup_id, row.price)
```

    63133 170.0
    313401 199.0
    248909 38.0
    208458 139.0
    110847 32.99


### Sort


```python
data[:5].sort_values(by='price', ascending=False)
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>adgroup_id</th>
      <th>cate_id</th>
      <th>campaign_id</th>
      <th>customer</th>
      <th>brand</th>
      <th>price</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>313401</td>
      <td>6406</td>
      <td>83237</td>
      <td>1</td>
      <td>87331.0</td>
      <td>199.00</td>
    </tr>
    <tr>
      <th>0</th>
      <td>63133</td>
      <td>6406</td>
      <td>83237</td>
      <td>1</td>
      <td>95471.0</td>
      <td>170.00</td>
    </tr>
    <tr>
      <th>3</th>
      <td>208458</td>
      <td>392</td>
      <td>83237</td>
      <td>1</td>
      <td>174374.0</td>
      <td>139.00</td>
    </tr>
    <tr>
      <th>2</th>
      <td>248909</td>
      <td>392</td>
      <td>83237</td>
      <td>1</td>
      <td>32233.0</td>
      <td>38.00</td>
    </tr>
    <tr>
      <th>4</th>
      <td>110847</td>
      <td>7211</td>
      <td>135256</td>
      <td>2</td>
      <td>145952.0</td>
      <td>32.99</td>
    </tr>
  </tbody>
</table>
</div>



### Index and Select


```python
data.reindex([0, 1])
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>adgroup_id</th>
      <th>cate_id</th>
      <th>campaign_id</th>
      <th>customer</th>
      <th>brand</th>
      <th>price</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>63133</td>
      <td>6406</td>
      <td>83237</td>
      <td>1</td>
      <td>95471.0</td>
      <td>170.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>313401</td>
      <td>6406</td>
      <td>83237</td>
      <td>1</td>
      <td>87331.0</td>
      <td>199.0</td>
    </tr>
  </tbody>
</table>
</div>




```python
data.iloc[0:3, 0:5]
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>adgroup_id</th>
      <th>cate_id</th>
      <th>campaign_id</th>
      <th>customer</th>
      <th>brand</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>63133</td>
      <td>6406</td>
      <td>83237</td>
      <td>1</td>
      <td>95471.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>313401</td>
      <td>6406</td>
      <td>83237</td>
      <td>1</td>
      <td>87331.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>248909</td>
      <td>392</td>
      <td>83237</td>
      <td>1</td>
      <td>32233.0</td>
    </tr>
  </tbody>
</table>
</div>




```python
data.loc[0:3, ['adgroup_id', 'brand']]
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>adgroup_id</th>
      <th>brand</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>63133</td>
      <td>95471.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>313401</td>
      <td>87331.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>248909</td>
      <td>32233.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>208458</td>
      <td>174374.0</td>
    </tr>
  </tbody>
</table>
</div>




```python
data[:4][['adgroup_id', 'brand']]
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>adgroup_id</th>
      <th>brand</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>63133</td>
      <td>95471.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>313401</td>
      <td>87331.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>248909</td>
      <td>32233.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>208458</td>
      <td>174374.0</td>
    </tr>
  </tbody>
</table>
</div>



Get rows with price greater than 100


```python
data[:10][data['price'] > 100]
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>adgroup_id</th>
      <th>cate_id</th>
      <th>campaign_id</th>
      <th>customer</th>
      <th>brand</th>
      <th>price</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>63133</td>
      <td>6406</td>
      <td>83237</td>
      <td>1</td>
      <td>95471.0</td>
      <td>170.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>313401</td>
      <td>6406</td>
      <td>83237</td>
      <td>1</td>
      <td>87331.0</td>
      <td>199.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>208458</td>
      <td>392</td>
      <td>83237</td>
      <td>1</td>
      <td>174374.0</td>
      <td>139.0</td>
    </tr>
    <tr>
      <th>5</th>
      <td>607788</td>
      <td>6261</td>
      <td>387991</td>
      <td>6</td>
      <td>207800.0</td>
      <td>199.0</td>
    </tr>
    <tr>
      <th>9</th>
      <td>28589</td>
      <td>5953</td>
      <td>395195</td>
      <td>13</td>
      <td>NaN</td>
      <td>428.0</td>
    </tr>
  </tbody>
</table>
</div>



### Groupby

Group the data by cate_id and sort it by the number of items


```python
data[:20].groupby('cate_id').adgroup_id.count().sort_values(ascending=False)
```




    cate_id
    4284    5
    5953    4
    6261    3
    6406    2
    392     2
    7213    1
    7211    1
    7207    1
    4520    1
    Name: adgroup_id, dtype: int64



Group the data by cate_id, calulate mean, and covert it to DataFrame


```python
data[:20].groupby('cate_id').price.mean().reset_index()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>cate_id</th>
      <th>price</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>392</td>
      <td>88.50</td>
    </tr>
    <tr>
      <th>1</th>
      <td>4284</td>
      <td>249.00</td>
    </tr>
    <tr>
      <th>2</th>
      <td>4520</td>
      <td>99.00</td>
    </tr>
    <tr>
      <th>3</th>
      <td>5953</td>
      <td>450.75</td>
    </tr>
    <tr>
      <th>4</th>
      <td>6261</td>
      <td>129.30</td>
    </tr>
    <tr>
      <th>5</th>
      <td>6406</td>
      <td>184.50</td>
    </tr>
    <tr>
      <th>6</th>
      <td>7207</td>
      <td>19.00</td>
    </tr>
    <tr>
      <th>7</th>
      <td>7211</td>
      <td>32.99</td>
    </tr>
    <tr>
      <th>8</th>
      <td>7213</td>
      <td>33.00</td>
    </tr>
  </tbody>
</table>
</div>



### Merge


```python
df1 = data[:5][['adgroup_id', 'price']]
df2 = data[:5][['adgroup_id', 'cate_id', 'price']]
```


```python
df1.head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>adgroup_id</th>
      <th>price</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>63133</td>
      <td>170.00</td>
    </tr>
    <tr>
      <th>1</th>
      <td>313401</td>
      <td>199.00</td>
    </tr>
    <tr>
      <th>2</th>
      <td>248909</td>
      <td>38.00</td>
    </tr>
    <tr>
      <th>3</th>
      <td>208458</td>
      <td>139.00</td>
    </tr>
    <tr>
      <th>4</th>
      <td>110847</td>
      <td>32.99</td>
    </tr>
  </tbody>
</table>
</div>




```python
df2.head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>adgroup_id</th>
      <th>cate_id</th>
      <th>price</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>63133</td>
      <td>6406</td>
      <td>170.00</td>
    </tr>
    <tr>
      <th>1</th>
      <td>313401</td>
      <td>6406</td>
      <td>199.00</td>
    </tr>
    <tr>
      <th>2</th>
      <td>248909</td>
      <td>392</td>
      <td>38.00</td>
    </tr>
    <tr>
      <th>3</th>
      <td>208458</td>
      <td>392</td>
      <td>139.00</td>
    </tr>
    <tr>
      <th>4</th>
      <td>110847</td>
      <td>7211</td>
      <td>32.99</td>
    </tr>
  </tbody>
</table>
</div>



Merge df1 and df2 into df3


```python
df3 = pd.merge(df1, df2)
df3.head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>adgroup_id</th>
      <th>price</th>
      <th>cate_id</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>63133</td>
      <td>170.00</td>
      <td>6406</td>
    </tr>
    <tr>
      <th>1</th>
      <td>313401</td>
      <td>199.00</td>
      <td>6406</td>
    </tr>
    <tr>
      <th>2</th>
      <td>248909</td>
      <td>38.00</td>
      <td>392</td>
    </tr>
    <tr>
      <th>3</th>
      <td>208458</td>
      <td>139.00</td>
      <td>392</td>
    </tr>
    <tr>
      <th>4</th>
      <td>110847</td>
      <td>32.99</td>
      <td>7211</td>
    </tr>
  </tbody>
</table>
</div>




```python
df3 = pd.merge(df1, df2, on='adgroup_id')
df3.head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>adgroup_id</th>
      <th>price_x</th>
      <th>cate_id</th>
      <th>price_y</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>63133</td>
      <td>170.00</td>
      <td>6406</td>
      <td>170.00</td>
    </tr>
    <tr>
      <th>1</th>
      <td>313401</td>
      <td>199.00</td>
      <td>6406</td>
      <td>199.00</td>
    </tr>
    <tr>
      <th>2</th>
      <td>248909</td>
      <td>38.00</td>
      <td>392</td>
      <td>38.00</td>
    </tr>
    <tr>
      <th>3</th>
      <td>208458</td>
      <td>139.00</td>
      <td>392</td>
      <td>139.00</td>
    </tr>
    <tr>
      <th>4</th>
      <td>110847</td>
      <td>32.99</td>
      <td>7211</td>
      <td>32.99</td>
    </tr>
  </tbody>
</table>
</div>



### Concat


```python
concat = pd.concat([data[:4], data[10:15]], axis=0)
concat 
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>adgroup_id</th>
      <th>cate_id</th>
      <th>campaign_id</th>
      <th>customer</th>
      <th>brand</th>
      <th>price</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>63133</td>
      <td>6406</td>
      <td>83237</td>
      <td>1</td>
      <td>95471.0</td>
      <td>170.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>313401</td>
      <td>6406</td>
      <td>83237</td>
      <td>1</td>
      <td>87331.0</td>
      <td>199.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>248909</td>
      <td>392</td>
      <td>83237</td>
      <td>1</td>
      <td>32233.0</td>
      <td>38.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>208458</td>
      <td>392</td>
      <td>83237</td>
      <td>1</td>
      <td>174374.0</td>
      <td>139.0</td>
    </tr>
    <tr>
      <th>10</th>
      <td>23236</td>
      <td>5953</td>
      <td>395195</td>
      <td>13</td>
      <td>NaN</td>
      <td>368.0</td>
    </tr>
    <tr>
      <th>11</th>
      <td>300556</td>
      <td>5953</td>
      <td>395195</td>
      <td>13</td>
      <td>NaN</td>
      <td>639.0</td>
    </tr>
    <tr>
      <th>12</th>
      <td>92560</td>
      <td>5953</td>
      <td>395195</td>
      <td>13</td>
      <td>NaN</td>
      <td>368.0</td>
    </tr>
    <tr>
      <th>13</th>
      <td>590965</td>
      <td>4284</td>
      <td>28145</td>
      <td>14</td>
      <td>454237.0</td>
      <td>249.0</td>
    </tr>
    <tr>
      <th>14</th>
      <td>529913</td>
      <td>4284</td>
      <td>70206</td>
      <td>14</td>
      <td>NaN</td>
      <td>249.0</td>
    </tr>
  </tbody>
</table>
</div>




```python
concat1 = pd.concat([data[:4], data[10:15]], axis=1)
concat1 
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>adgroup_id</th>
      <th>cate_id</th>
      <th>campaign_id</th>
      <th>customer</th>
      <th>brand</th>
      <th>price</th>
      <th>adgroup_id</th>
      <th>cate_id</th>
      <th>campaign_id</th>
      <th>customer</th>
      <th>brand</th>
      <th>price</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>63133.0</td>
      <td>6406.0</td>
      <td>83237.0</td>
      <td>1.0</td>
      <td>95471.0</td>
      <td>170.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>313401.0</td>
      <td>6406.0</td>
      <td>83237.0</td>
      <td>1.0</td>
      <td>87331.0</td>
      <td>199.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>248909.0</td>
      <td>392.0</td>
      <td>83237.0</td>
      <td>1.0</td>
      <td>32233.0</td>
      <td>38.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3</th>
      <td>208458.0</td>
      <td>392.0</td>
      <td>83237.0</td>
      <td>1.0</td>
      <td>174374.0</td>
      <td>139.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>10</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>23236.0</td>
      <td>5953.0</td>
      <td>395195.0</td>
      <td>13.0</td>
      <td>NaN</td>
      <td>368.0</td>
    </tr>
    <tr>
      <th>11</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>300556.0</td>
      <td>5953.0</td>
      <td>395195.0</td>
      <td>13.0</td>
      <td>NaN</td>
      <td>639.0</td>
    </tr>
    <tr>
      <th>12</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>92560.0</td>
      <td>5953.0</td>
      <td>395195.0</td>
      <td>13.0</td>
      <td>NaN</td>
      <td>368.0</td>
    </tr>
    <tr>
      <th>13</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>590965.0</td>
      <td>4284.0</td>
      <td>28145.0</td>
      <td>14.0</td>
      <td>454237.0</td>
      <td>249.0</td>
    </tr>
    <tr>
      <th>14</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>529913.0</td>
      <td>4284.0</td>
      <td>70206.0</td>
      <td>14.0</td>
      <td>NaN</td>
      <td>249.0</td>
    </tr>
  </tbody>
</table>
</div>




```python
concat2 = pd.concat([data[:4], data[10:15].reset_index()], axis=1)
concat2 
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>adgroup_id</th>
      <th>cate_id</th>
      <th>campaign_id</th>
      <th>customer</th>
      <th>brand</th>
      <th>price</th>
      <th>index</th>
      <th>adgroup_id</th>
      <th>cate_id</th>
      <th>campaign_id</th>
      <th>customer</th>
      <th>brand</th>
      <th>price</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>63133.0</td>
      <td>6406.0</td>
      <td>83237.0</td>
      <td>1.0</td>
      <td>95471.0</td>
      <td>170.0</td>
      <td>10</td>
      <td>23236</td>
      <td>5953</td>
      <td>395195</td>
      <td>13</td>
      <td>NaN</td>
      <td>368.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>313401.0</td>
      <td>6406.0</td>
      <td>83237.0</td>
      <td>1.0</td>
      <td>87331.0</td>
      <td>199.0</td>
      <td>11</td>
      <td>300556</td>
      <td>5953</td>
      <td>395195</td>
      <td>13</td>
      <td>NaN</td>
      <td>639.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>248909.0</td>
      <td>392.0</td>
      <td>83237.0</td>
      <td>1.0</td>
      <td>32233.0</td>
      <td>38.0</td>
      <td>12</td>
      <td>92560</td>
      <td>5953</td>
      <td>395195</td>
      <td>13</td>
      <td>NaN</td>
      <td>368.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>208458.0</td>
      <td>392.0</td>
      <td>83237.0</td>
      <td>1.0</td>
      <td>174374.0</td>
      <td>139.0</td>
      <td>13</td>
      <td>590965</td>
      <td>4284</td>
      <td>28145</td>
      <td>14</td>
      <td>454237.0</td>
      <td>249.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>14</td>
      <td>529913</td>
      <td>4284</td>
      <td>70206</td>
      <td>14</td>
      <td>NaN</td>
      <td>249.0</td>
    </tr>
  </tbody>
</table>
</div>



### Sum


```python
a = { 'A' : [ 1, 2, 3 ] , 'B' : [100,200, 300 ]} 
d = pd.DataFrame( a ) 
print(d)
```

       A    B
    0  1  100
    1  2  200
    2  3  300



```python
d.sum(axis=0)
```




    A      6
    B    600
    dtype: int64




```python
d.sum(axis=1)
```




    0    101
    1    202
    2    303
    dtype: int64



### Add Row and Column


```python
d.append(d.sum(axis=0), ignore_index=True)
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>100</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>200</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>300</td>
    </tr>
    <tr>
      <th>3</th>
      <td>6</td>
      <td>600</td>
    </tr>
  </tbody>
</table>
</div>




```python
d['sum'] = d.sum(axis=1)
d
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>sum</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>100</td>
      <td>101</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>200</td>
      <td>202</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>300</td>
      <td>303</td>
    </tr>
  </tbody>
</table>
</div>


